<!DOCTYPE html>
<html lang="ko"
      xmlns:th="<http://www.thymeleaf.org>"
      xmlns:layout="<http://www.ultraq.net.nz/thymeleaf/layout>"
      layout:decorate="~{common/common}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title layout:fragment="title">Seongsu Bean - 내가 쓴 글</title>
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="/static/css/myPost.css">
</head>
<body>
<!-- 메인 콘텐츠 -->
<main class="main-content">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <h1 class="page-title">내가 쓴 글 총 4개</h1>

        <div class="posts-table">
          <div class="table-responsive">
            <table class="table">
              <thead>
              <tr>
                <th style="width: 15%;">종류</th>
                <th style="width: 60%;">제목</th>
                <th style="width: 25%;">날짜</th>
              </tr>
              </thead>
              <tbody>
              <!-- Thymeleaf 반복문으로 게시글 목록 표시 -->
              <tr th:each="post : ${posts}" th:if="${posts != null and !posts.isEmpty()}">
                <td>
                      <span class="post-type"
                            th:classappend="${post.category == 'CAFE'} ? 'type-cafe' : (${post.category == 'FREE'} ? 'type-free' : 'type-report')"
                            th:text="${post.category == 'CAFE'} ? '카페' : (${post.category == 'FREE'} ? '자유' : '제보')">
                        카페
                      </span>
                </td>
                <td>
                  <a href="#" th:href="@{'/posts/' + ${post.id}}" class="post-title" th:text="${post.title}">
                    성수동 맛집 카페 추천합니다
                  </a>
                </td>
                <td>
                      <span class="post-date" th:text="${#temporals.format(post.createdDate, 'yyyy-MM-dd')}">
                        2024-01-15
                      </span>
                </td>
              </tr>

              <!-- 샘플 데이터 (posts가 없을 때) -->
              <tr >
                <td>
                  <span class="post-type type-cafe">카페</span>
                </td>
                <td>
                  <a href="#" class="post-title">성수동 맛집 카페 추천합니다</a>
                </td>
                <td>
                  <span class="post-date">2024-01-15</span>
                </td>
              </tr>
              <tr >
                <td>
                  <span class="post-type type-free">자유</span>
                </td>
                <td>
                  <a href="#" class="post-title">오늘 날씨가 정말 좋네요</a>
                </td>
                <td>
                  <span class="post-date">2024-01-14</span>
                </td>
              </tr>
              <tr >
                <td>
                  <span class="post-type type-report">제보</span>
                </td>
                <td>
                  <a href="#" class="post-title">새로운 카페 오픈 소식</a>
                </td>
                <td>
                  <span class="post-date">2024-01-13</span>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
        <!-- 페이지네이션 -->
        <div class="pagination-container" th:if="${totalPages > 1}">
          <nav aria-label="Page navigation">
            <ul class="pagination">
              <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                <a class="page-link" th:href="@{/mypage/posts(page=${currentPage - 1})}" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                </a>
              </li>
              <li class="page-item"
                  th:each="pageNum : ${#numbers.sequence(0, totalPages - 1)}"
                  th:classappend="${pageNum == currentPage} ? 'active'">
                <a class="page-link" th:href="@{/mypage/posts(page=${pageNum})}" th:text="${pageNum + 1}">1</a>
              </li>
              <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                <a class="page-link" th:href="@{/mypage/posts(page=${currentPage + 1})}" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Bootstrap 5.3.2 JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // 테이블 행 클릭 시 상세 페이지로 이동
  document.querySelectorAll('tbody tr').forEach(row => {
    row.addEventListener('click', function(e) {
      if (e.target.tagName !== 'A') {
        const link = this.querySelector('.post-title');
        if (link) {
          window.location.href = link.href;
        }
      }
    });

    // 마우스 오버 효과
    row.style.cursor = 'pointer';
  });
  // 반응형 테이블 스크롤 알림
  const tableContainer = document.querySelector('.table-responsive');
  if (tableContainer.scrollWidth > tableContainer.clientWidth) {
    tableContainer.style.borderLeft = '3px solid #8B4513';
    tableContainer.style.borderRight = '3px solid #8B4513';
  }
</script>
</body>
</html>