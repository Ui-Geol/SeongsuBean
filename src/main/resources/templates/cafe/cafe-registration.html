<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/common}">
<head>
  <title layout:fragment="title">카페 등록</title>
  <link layout:fragment="styles" rel="stylesheet" href="/css/cafe/cafe-registration.css" />
</head>
<body>
<div layout:fragment="content">
  <div class="cafe-regist-container">
    <div class="form-wrapper">
      <h1 class="form-title">카페 만들기</h1>
      


      <!-- 화면 테스트용 폼 -->
      <!--/*@thymesVar id="CafeDTO" type=""*/-->
      <form id="cafeForm" class="cafe-form" th:action="@{/cafe/register}" th:object="${CafeDTO}" method="post" enctype="multipart/form-data"
      >
        <div class="form-group">
          <label for="cafeName">카페이름</label>
          <input type="text" id="cafeName" name="cafeName" placeholder="이름을 입력해주세요" required>
        </div>

        <!-- ①: 주소 검색 필드 (변경된 부분) -->
        <div class="form-group">
          <label for="address">주소</label>
          <button type="button" id="btnAddressSearch">주소검색</button>
          <input
              type="text"
              id="address"
              name="address"
              placeholder="주소를 입력해주세요"
              readonly
              required
          />
          <label for="zipCode"></label><input
              type="text"
              id="zipCode"
              name="zipCode"
              placeholder="우편번호"
              readonly
              required
          />
          <label for="detailAddress"></label><input
              type="text"
              id="detailAddress"
              name="detailAddress"
              placeholder="상세주소를 입력해주세요"
              required
          />
        </div>

        <div class="form-group">
          <label for="phone">전화번호</label>
          <input type="tel" id="phone" name="phone" placeholder="전화번호를 입력해주세요" required>
        </div>

        <div class="form-group">
          <label for="description">소개</label>
          <textarea id="description" name="description" placeholder="최대 300자"
                    maxlength="300"></textarea>
          <div class="char-count">
            <span id="charCount">0</span>/300
          </div>
        </div>

        <!-- 4) 숨겨진 input: 영업시간 JSON을 담을 필드 -->
        <input
            type="hidden"
            id="businessHoursJson"
            name="businessHoursJson"
            th:value="''"
        />

        <!-- 2) 영업시간 리스트 -->
        <div class="mb-3">
          <label class="form-label">영업시간</label>
          <div id="business-hours-container" class="d-flex flex-wrap gap-2"></div>
          <button type="button" id="add-business-hours-btn" class="btn btn-sm btn-primary mt-2">
            영업시간 추가
          </button>
        </div>

<!--        &lt;!&ndash; 3) JSON 전송 버튼 &ndash;&gt;-->
<!--        <button id="submitBtn" class="btn btn-success">등록하기</button>-->

        <!-- 8) 영업시간 템플릿: JS가 복제해서 사용 -->
        <template id="tpl-business-hours">
          <div class="business-hours-group d-flex align-items-end mb-2">
            <!-- ① 요일 선택 -->
            <select class="weekday-select form-select me-2" required>
              <option value="">요일</option>
              <option value="월">월</option>
              <option value="화">화</option>
              <option value="수">수</option>
              <option value="목">목</option>
              <option value="금">금</option>
              <option value="토">토</option>
              <option value="일">일</option>
            </select>

            <!-- ② 시작시간 (HTML5 time) -->
            <input
                type="time"
                class="open-time-input form-control me-2"
                step="900"
                required
            />

            <!-- ③ 종료시간 (HTML5 time) -->
            <input
                type="time"
                class="close-time-input form-control me-2"
                step="900"
                required
            />

            <!-- ④ 그룹 삭제 버튼 -->
            <button type="button" class="btn btn-outline-danger btn-remove-hours">
              삭제
            </button>
          </div>
        </template>

        <!-- 6) 이미지 업로드 영역 -->
        <div class="form-group">
          <div class="image-upload" id="imageUpload">
            <div class="upload-content">
              <div class="upload-icon">📷</div>
              <span class="upload-text">사진 추가</span>
            </div>
            <input type="file" id="imageInput" name="images" accept="image/*" multiple
                   style="display: none;">
          </div>
          <div id="imagePreview" class="image-preview"></div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-cancel" id="cancelBtn">취소</button>
          <button type="submit" class="btn btn-submit">등록</button>
        </div>
      </form>
    </div>
  </div>
</div>
<th:block layout:fragment="scripts">
  <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <script th:src="@{/js/cafe/cafe-registration.js}"></script>
</th:block>
</body>
</html>